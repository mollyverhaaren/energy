# Results

```{r}
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
```
## Setting the Scene: Renewable Integration in the U.S. Over Time:

Understanding the trajectory of U.S. electricity generation over the past three decades provides context for the challenges and opportunities presented by renewable energy integration. The plot below serves as the foundation of our analysis, showing the shift in energy sources from 1990 to 2023. It highlights: 

- The decline of coal and petroleum-based generation
- The rise of natural gas
- The rapid growth of intermittent renewables (wind and solar), especially in the past decade
- The consistency of other renewables, which include hydroelectric, geothermal, and biomass

We focus this analysis on wind and solar electricity generation because they provide clean but intermittent energy (after all, we can't control when the wind is blowing and the sun is shining!). As the U.S. works to reduce carbon emissions and combat climate change, the grid will be more reliant on these intermittent energy sources, so understanding their impact on grid reliability is crucial. 

Total area adds up to total gen in any given yesr.... capacity vs gen

```{r, fig.width = 10}
us_gen_data <- read.csv("US_generation.csv")

colnames(us_gen_data)[1] <- "Year"

us_gen_data <- us_gen_data |>
  filter(Year >= 1990)

data1_long <- us_gen_data |>
  select(Year, wind, solar, `coal`, `natural.gas`, `nuclear`, `other.renewables`, `petroleum.and.other`) |>
  pivot_longer(cols = -Year, names_to = "Energy_Source", values_to = "Generation")

# Set factor levels (wind and solar at the top)
data1_long$Energy_Source <- factor(data1_long$Energy_Source, 
                                  levels = c("solar","wind","other.renewables", "nuclear", "natural.gas",
                                             "petroleum.and.other", "coal"))
# Area Chart
ggplot(data1_long, aes(x = Year, y = Generation, fill = Energy_Source)) +
  geom_area(alpha = 0.8, position = "stack") +
  scale_fill_manual(values = c("coal" = "gray10", 
                               "natural.gas" = "gray50", 
                               "nuclear" = "gray80", 
                               "other.renewables" = "cornflowerblue", 
                               "petroleum.and.other" = "gray30",
                               "wind" = "green4",
                               "solar" = "yellow")) +
  labs(title = "US Electricity Generation (MW) by Source 1990-2023",
       x = "Year",
       y = "Electricity Generation (MW)",
       fill = "Energy Source") +
  theme_minimal()
```

The plot above may make it seem like wind and solar are not responsible for a large portion of the energy generation in the U.S., but if we plot their share of the country's total generation mix from 1990 to 2023, we see the  
Further, the EIA forecasts this share to keep growing at a very rapid pace through the mid-2030s, and reaching nearly half of the country's electricity generation by 2050.

```{r, fig.width = 10}

# Add a new column to calculate the fraction of wind + solar generation
data2 <- us_gen_data |>
  mutate(
    Total_Generation = wind + solar + coal + natural.gas + nuclear + other.renewables + petroleum.and.other,
    Wind_Solar_Fraction = (wind + solar) / Total_Generation
  )

# Find the last data point
last_point <- data2 |> filter(Year == max(Year))

# Load and prepare the forecast data in R
forecast <- read.csv("Renewable_Energy_Forecast.csv") |>
  select(Year, Solar_Wind_Fraction) |>
  rename(Solar_Wind_Fraction = Solar_Wind_Fraction)

# Combine the historical and forecast data for plotting
combined_data <- bind_rows(
  data2 |> select(Year, Wind_Solar_Fraction) |> rename(Fraction = Wind_Solar_Fraction),
  forecast |> rename(Fraction = Solar_Wind_Fraction)
)

# Find the last data point
last_point2 <- forecast |> filter(Year == max(Year))

# Plot with the forecast
ggplot(data2, aes(x = Year, y = Wind_Solar_Fraction)) +
  geom_line(color = "darkolivegreen4", linewidth = 1.2) +
  geom_line(data = forecast, aes(x = Year, y = Solar_Wind_Fraction),
            color = "darkolivegreen4", linetype = "dashed", linewidth = 1.2) +
  geom_point(data = last_point, aes(x = Year, y = Wind_Solar_Fraction), 
             size = 2.5, color = "darkolivegreen4") +
  geom_text(data = last_point, aes(label = scales::percent(Wind_Solar_Fraction, accuracy = 0.1)),
            vjust = -0.5, hjust = 1, color = "darkolivegreen4") +
  geom_text(data = forecast |> filter(Year == 2050),
            aes(x = Year, y = Solar_Wind_Fraction,
                label = scales::percent(Solar_Wind_Fraction, accuracy = 0.1)),
            vjust = -0.5, hjust = -0.1, color = "darkolivegreen4") + 
 geom_point(data = last_point2, aes(x = Year, y = Solar_Wind_Fraction), 
             size = 2.5, color = "darkolivegreen4") +
  labs(title = "Wind & Solar as a Fraction of Total Electricity Generation (Historical 1990 - 2023 and Forecast 2024-2050)",
       x = "Year",
       y = "Fraction of Total Generation") +
  theme_minimal() +
  scale_y_continuous(labels = scales::percent_format())+
  scale_x_continuous(breaks = seq(1990, 2050, by = 5)) 
```

## Grid Reliability:

Talk about why grid reliability is important, explain reliability metrics

- CAIDI:(is actually just saidi * saifi) Customer Average Interruption Duration Index. It is average number of minutes it takes to restore non-momentary electric interruptions.
- SAIDI:System Average Interruption Duration Index. It is the minutes of non-momentary electric interruptions, per year, the average customer experienced.
- SAIFI:System Average Interruption Frequency Index. It is the number of non-momentary electric interruptions, per year, the average customer experienced.

Conclusion from this is that reliability is probs much more related to lack of extreme weather events than renewable penetration... could be interesting to track down states with major weather events vs those without and see if there is correlation in what we're seeing here  (good conclusion for the entire project: extreme weather event contributes to lack of reliability much more than renewable integration, makes an even stronger case for the energy transition which can hopefully mitigate or slow down climate change that brings extreme weather) (Can look at winter storm Uri in texas Feb 2021?, California 2022 heatwaves?)

Probably should get rid of saifi? or include as bar on secondary axis but we;ve been told no secondary axes

```{r, fig.width = 10}

t1_reliability <- read.csv("T1_Reliability.csv")

t1_reliability <- t1_reliability |>
   filter(`Event_Category` %in% c("IEEE_All_Events", "IEEE_No_Major_Events"))

t1_reliability$Year <- as.integer(t1_reliability$Year)

# Reshape the data to a long format for plotting
#data3_long <- t1_reliability  |>
#  pivot_longer(cols = c(SAIDI, SAIFI, CAIDI), names_to = "Metric", values_to = "Value")

data3_long <- t1_reliability  |>
  pivot_longer(cols = c(SAIDI, CAIDI), names_to = "Metric", values_to = "Value")

# Plot the line graph faceted by Event Category
ggplot(data3_long, aes(x = Year, y = Value, color = Metric)) +
  geom_line(linewidth = 1.2) +
  scale_x_continuous(breaks = seq(2013, 2023, 1)) +
  #scale_y_continuous(expand = c(0, 0)) +
  labs(title = "Reliability Metrics (2013â€“2023)",
       x = "Year",
       y = "Value",
       color = "Metric") +
  facet_wrap(~ `Event_Category`) +
  theme_minimal()
```
